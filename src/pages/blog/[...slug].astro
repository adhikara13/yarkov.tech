---
import type { MDXInstance } from "astro";

import ArticleLayout from "@layouts/article.astro";
import { getLanguageFromURL } from "@root/utils";

const lang = getLanguageFromURL(Astro.url.pathname);

export async function getStaticPaths() {
	const data = await Astro.glob<ArticleType>("../../../content/articles/**/*.mdx");
	return data.map((article) => {
		const published_at = new Date(article.frontmatter.published_at).toLocaleDateString("en-CA");
		const slug = `${published_at}/${article.frontmatter.slug}`;
		return { params: { slug }, props: article };
	});
}

const { Content, frontmatter } = Astro.props as MDXInstance<ArticleType>;
---

<ArticleLayout lang={lang} content={frontmatter}>
	<Content />
</ArticleLayout>
