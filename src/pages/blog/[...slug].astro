---
import type { MarkdownInstance } from 'astro';

import ArticleLayout from '@root/layouts/article.astro';

// TODO: generate pages based on user language
export async function getStaticPaths() {
	const data = await Astro.glob<ArticleType>('../../../content/articles/**/*.md');
	return data.map((article) => {
		const published_at = new Date(article.frontmatter.published_at).toLocaleDateString('en-CA');
		const slug = `${published_at}/${article.frontmatter.slug}`;
		const props = { Content: article.Content, frontmatter: article.frontmatter };
		return { params: { slug }, props };
	});
}

const { Content, frontmatter: data } = Astro.props as MarkdownInstance<ArticleType>;
---

<ArticleLayout content={data}>
	<Content />
</ArticleLayout>
